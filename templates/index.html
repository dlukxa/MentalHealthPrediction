<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mental Health Predictor</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <style>
        body {font-family: Arial, Helvetica, sans-serif;}
        
        #prediction-form{
            width:100%;
            float: center;
        }

        /* The Modal (background) */
        .modal {
          display: none; /* Hidden by default */
          position: fixed; /* Stay in place */
          z-index: 1; /* Sit on top */
          left: 0;
          top: 0;
          width: 100%; /* Full width */
          height: 100%; /* Full height */
          overflow: auto; /* Enable scroll if needed */
          background-color: rgb(0,0,0); /* Fallback color */
          background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
          -webkit-animation-name: fadeIn; /* Fade in the background */
          -webkit-animation-duration: 0.4s;
          animation-name: fadeIn;
          animation-duration: 0.4s
        }
        
        /* Modal Content */
        .modal-content {
          position: fixed;
          bottom: 0;
          background-color: #fefefe;
          width: 100%;
          -webkit-animation-name: slideIn;
          -webkit-animation-duration: 0.4s;
          animation-name: slideIn;
          animation-duration: 0.4s
        }
        
        /* The Close Button */
        .close {
          color: white;
          float: right;
          font-size: 28px;
          font-weight: bold;
        }
        
        .close:hover,
        .close:focus {
          color: #000;
          text-decoration: none;
          cursor: pointer;
        }
        
        .modal-header {
          padding: 2px 16px;
          background-color: #0d6dfd7e;
          color: white;
        }
        
        .modal-body {padding: 2px 16px;}
        
        
        /* Add Animation */
        @-webkit-keyframes slideIn {
          from {bottom: -300px; opacity: 0} 
          to {bottom: 0; opacity: 1}
        }
        
        @keyframes slideIn {
          from {bottom: -300px; opacity: 0}
          to {bottom: 0; opacity: 1}
        }
        
        @-webkit-keyframes fadeIn {
          from {opacity: 0} 
          to {opacity: 1}
        }
        
        @keyframes fadeIn {
          from {opacity: 0} 
          to {opacity: 1}
        }
        </style>
</head>
<body>
    <div class="container">
        <div class="row justify-content-md-center mb-4" >


            <form id="prediction-form">
                <h1>Mental Health Predictor</h1>

            <div class="alert alert-info" role="alert">
                This tool uses a machine learning model to estimate the likelihood of developing depression based on various factors. The results are probabilistic and should not be interpreted as a diagnosis.  It's crucial to consult with a mental health professional for proper evaluation and treatment.  This tool is for informational purposes only.
                </div>
            <div class="card mt-3">
                <div class="card-body">
                    <label for="gender" class="form-label">Gender:</label>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="gender" id="genderFemale" value="0" checked>
                        <label class="form-check-label" for="genderFemale">Female</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="gender" id="genderMale" value="1">
                        <label class="form-check-label" for="genderMale">Male</label>
                    </div>
                </div>
            </div>

            <div class="card mt-3">
                <div class="card-body">
                    <label for="age" class="form-label">Age:</label>
                    <input type="number" class="form-control" placeholder="30" id="age" name="age" required>
                </div>
            </div>

            <div class="card mt-3">
                <div class="card-body">
                <label for="work_pressure" class="form-label">Work Pressure:</label>
                    <div class="rating">
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="work_pressure" id="work_pressure1" value="1">
                            <label class="form-check-label" for="work_pressure1">1</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="work_pressure" id="work_pressure2" value="2">
                            <label class="form-check-label" for="work_pressure2">2</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="work_pressure" id="work_pressure3" value="3">
                            <label class="form-check-label" for="work_pressure3">3</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="work_pressure" id="work_pressure4" value="4">
                            <label class="form-check-label" for="work_pressure4">4</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="work_pressure" id="work_pressure5" value="5">
                            <label class="form-check-label" for="work_pressure5">5</label>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card mt-3">
                <div class="card-body">    
                    <label for="job_satisfaction" class="form-label">Job Satisfaction:</label>
                    <div class="rating">
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="job_satisfaction" id="job_satisfaction1" value="1">
                            <label class="form-check-label" for="job_satisfaction1">1</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="job_satisfaction" id="job_satisfaction2" value="2">
                            <label class="form-check-label" for="job_satisfaction2">2</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="job_satisfaction" id="job_satisfaction3" value="3">
                            <label class="form-check-label" for="job_satisfaction3">3</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="job_satisfaction" id="job_satisfaction4" value="4">
                            <label class="form-check-label" for="job_satisfaction4">4</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="job_satisfaction" id="job_satisfaction5" value="5">
                            <label class="form-check-label" for="job_satisfaction5">5</label>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card mt-3">
                <div class="card-body">    
                <label for="sleep_duration" class="form-label">Sleep Duration:</label>
                <select class="form-select" id="sleep_duration" name="sleep_duration">
                    <option value="1">5 hours</option>
                    <option value="2">5-6 hours</option>
                    <option value="3">7-8 hours</option>
                    <option value="4">>8 hours</option>
                </select>
                </div>
            </div>


            <div class="card mt-3">
                <div class="card-body">                
                    <label for="dietary_habits" class="form-label">Dietary Habits:</label>
                    <select class="form-select" id="dietary_habits" name="dietary_habits">
                    <option value="0">Unhealthy (Rarely eat fruits/vegetables, frequent processed foods, sugary drinks)</option>
                    <option value="1">Moderate (Some fruits/vegetables, balance of processed and whole foods)</option>
                    <option value="2">Healthy (Frequent fruits/vegetables, primarily whole foods, limited processed foods)</option>
                    </select>
                </div>
            </div>

            <div class="card mt-3">
                <div class="card-body">
                    <label for="suicidal_thoughts" class="form-label">Have you experienced any thoughts of self-harm or suicide in the past month?</label>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="suicidal_thoughts" id="suicidal_thoughtsNo" value="0" checked>
                        <label class="form-check-label" for="suicidal_thoughtsNo">No</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="suicidal_thoughts" id="suicidal_thoughtsYes" value="1">
                        <label class="form-check-label" for="suicidal_thoughtsYes">Yes</label>
                    </div>
                    <p class="text-danger">If you answered yes, please seek immediate help. Contact a crisis hotline or mental health professional.</p>
                </div>
            </div>

            <div class="card mt-3">
                <div class="card-body">
                    <label for="work_hours" class="form-label">Work Hours:</label>
                    <input type="number" class="form-control" placeholder="6" id="work_hours" name="work_hours" required>
                </div>
            </div>


            <div class="card mt-3">
                <div class="card-body">
                    <label for="financial_stress" class="form-label">Financial Stress:</label>
                    <div class="rating">
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="financial_stress" id="financial_stress1" value="1">
                            <label class="form-check-label" for="financial_stress1">1</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="financial_stress" id="financial_stress2" value="2">
                            <label class="form-check-label" for="financial_stress2">2</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="financial_stress" id="financial_stress3" value="3">
                            <label class="form-check-label" for="financial_stress3">3</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="financial_stress" id="financial_stress4" value="4">
                            <label class="form-check-label" for="financial_stress4">4</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="financial_stress" id="financial_stress5" value="5">
                            <label class="form-check-label" for="financial_stress5">5</label>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card mt-3">
                <div class="card-body">

                    <label for="family_history" class="form-label">Is there a history of mental illness (such as depression, anxiety, or other diagnosable conditions) in your immediate family (parents, siblings)?</label>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="family_history" id="family_historyNo" value="0" checked>
                        <label class="form-check-label" for="family_historyNo">No</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="family_history" id="family_historyYes" value="1">
                        <label class="form-check-label" for="family_historyYes">Yes</label>
                    </div>
                    <p class="text-muted">This question helps assess potential risk factors.  A family history doesn't confirm a diagnosis.  Consult a healthcare professional if you have concerns.</p>
                
                </div>
            </div>

            <div class="card mt-3">
                <div class="card-body">
                    <h5 class="card-title">Ready to Predict?</h5>
                    <p class="card-text">Click the button below to run the prediction and see your results.</p>
                    <button type="submit" id="myBtn" class="btn btn-primary btn-lg">Get Prediction</button>
                </div>
            </div>
        </form>

    </div>
<!-- The Modal -->
<div id="myModal" class="modal">

    <!-- Modal content -->
    <div class="modal-content">
        <div class="modal-header">
            <span class="close">&times;</span>
          </div>
          <div class="modal-body"  id="result">
            </div>
    </div>
  
  </div>
  
  <script>
  // Get the modal
  var modal = document.getElementById("myModal");
  
  // Get the button that opens the modal
  var btn = document.getElementById("myBtn");
  
  // Get the <span> element that closes the modal
  var span = document.getElementsByClassName("close")[0];
  
  // When the user clicks the button, open the modal 
  btn.onclick = function() {
    modal.style.display = "block";
  }
  
  // When the user clicks on <span> (x), close the modal
  span.onclick = function() {
    modal.style.display = "none";
  }
  
  // When the user clicks anywhere outside of the modal, close it
  window.onclick = function(event) {
    if (event.target == modal) {
      modal.style.display = "none";
    }
  }
  </script>
    <script>
        $(document).ready(function() {
            $("#prediction-form").on("submit", function(e) {
                e.preventDefault();
                const data = {
                    gender: parseInt($('input[name="gender"]:checked').val()),
                    age: parseInt($("#age").val()),
                    work_pressure: parseInt($('input[name="work_pressure"]:checked').val()),
                    job_satisfaction: parseInt($('input[name="job_satisfaction"]:checked').val()),
                    sleep_duration: parseInt($("#sleep_duration").val()),
                    dietary_habits: parseInt($("#dietary_habits").val()),
                    suicidal_thoughts: parseInt($('input[name="suicidal_thoughts"]:checked').val()),
                    work_hours: parseInt($("#work_hours").val()),
                    financial_stress: parseInt($('input[name="financial_stress"]:checked').val()),
                    family_history: parseInt($('input[name="family_history"]:checked').val())
                };

                $.ajax({
                    url: "/predict",
                    type: "POST",
                    contentType: "application/json",
                    data: JSON.stringify(data),
                    success: function(response) {
                        $("#result").html(`
                        

                <h2>Risk Level: ${response.risk_level}</h2>
            <p>Probability of Depression: ${response.probability.toFixed(2)}</p>
            <p>${response.description}</p>
                        `);
                    },
                    error: function(err) {
                        $("#result").html(`<p style="color: red;">Error: ${err.responseJSON.error}</p>`);
                    }
                });
            });
        });
    </script>
</body>
</html>